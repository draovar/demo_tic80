-- global
GRAVITY = 0.75
FRICTION = 0.75
AIR = 0.90
MAX_SEED = 6
t=0

-- animations --
idle_animation = {
	id = 256,
	num = 8,
	speed = 16,
	counter = 0,
	w = 2,
	h = 2,
	loop = 1,
}
run_animation = {
	id = 288,
	num = 8,
	speed = 6,
	counter = 0,
	w = 2,
	h = 2,
	loop = 1,
}
jump_animation = {
	id = 320,
	num = 2,
	speed = 4,
	counter = 0,
	w = 2,
	h = 2,
	loop = 1,
}
fall_animation = {
	id = 324,
	num = 4,
	speed = 4,
	counter = 0,
	w = 2,
	h = 2,
	loop = 0,
}

jump2_animation = {
	id = 352,
	num = 6,
	speed = 2,
	counter = 0,
	w = 2,
	h = 2,
	loop = 0,
}
test_animation = {
	id = 34,
	num = 1,
	speed = 4,
	counter = 0,
	w = 2,
	h = 2,
	loop = 0,
}

player = {
	x = 400,
	y = 24,
	w = 16,
	h = 16,
	dx = 0,
	dy = 0,
	s = 2,
    j = 6,
    on_ground = false,
	anim = idle_animation,
	state = "idle",
	counter = 0,
	flip = 0,
    jumps = 0,
    max_jumps = 2,
	dmg_cd = 0,
	hp = 5,
	ox = 4,
}

camera = {
	x = 0,
	y = 0,
}

function update_camera()
    -- center camera on player
    camera.x = player.x - 120  -- 240 / 2
    --camera.y = player.y - 68   -- 136 / 2

    -- clamp camera to map bounds
    camera.x = math.max(0, math.min(camera.x, (240*8)-240))
    --camera.y = math.max(0, math.min(camera.y, (136*8)-136))
end

function TIC()
	cls()
	--map(0,0,30,17,0,0,-1,1)
	local map_x = math.floor(camera.x / 8)
	local map_y = math.floor(camera.y / 8)
	local offset_x = -(camera.x % 8)
	local offset_y = -(camera.y % 8)
	map(map_x, map_y, 31, 18, offset_x, offset_y)
	

	if player.hp > 0 or player.dmg_cd > 0 then
		update_player()
		update_camera()
    	player.counter = draw_object(player)
		--debug(player)
	else 
		for i=0, 16, 1 do
			for j=0, 29, 1 do
				spr(36, j*8, i*8, 0)
			end
		end
		print("YOU DIED!", 74, 62, 14, false, 2)
		print("YOU DIED!", 75, 63, 15, false, 2)
	end
	draw_ui()
	--print("dx = " .. player.dx .. ", dy = " .. player.dy, 0, 0)
	t=t+1
end


function player_input()
	-- movement --
	if (btnp(0) or btnp(4)) and 
    player.jumps < player.max_jumps then
        player.jumps = player.jumps + 1
		player.dy = -player.j 
	end
    ---if btn(0) then player.dy = -player.s end
	if btn(1) then player.dy = player.s end
	if btn(2) then player.dx = -player.s end
	if btn(3) then player.dx = player.s end
end

function player_states()
	local new_state = ""

	if player.on_ground == false then
        if player.dy > 1 then 
            new_state = "fall"
        elseif player.jumps > 1 then
            new_state = "double_jump"
        else
		    new_state = "jump"
        end
    elseif player.on_ground == true then
        player.jumps = 0    
        if player.dx == 0 then
            new_state = "idle"
        elseif player.dx ~= 0 then
            new_state = "run"
        end
    end

	if player.state ~= new_state then
        player.counter = 0
        player.state = new_state
		if new_state == "idle" then
			player.anim = idle_animation
		elseif new_state == "run" then
			player.anim = run_animation
		elseif new_state == "jump" then
			player.anim = jump_animation
        elseif new_state == "fall" then
            player.anim = fall_animation
        elseif new_state == "double_jump" then
            player.anim = jump2_animation
        end
	end

	if player.dx < 0 then
		player.flip = 1
	elseif player.dx > 0 then
		player.flip = 0
	end

end

function draw_ui()
	for i = 0, player.hp - 1, 1 do
		spr(240, 1 + i*9, 1, 1)
	end
	if player.dmg_cd > 0 and player.dmg_cd % 1.5 ==0 then
		spr(240, 1 + player.hp*9, 1, 1)
	end
end

function debug(obj)
	local top_left  = {x = (obj.x + obj.ox),             y = (obj.y)}
	local bot_left  = {x = (obj.x + obj.ox),             y = (obj.y + obj.h - 1)}
	local top_right = {x = (obj.x + obj.w - 1 - obj.ox), y = (obj.y)}
	local bot_right = {x = (obj.x + obj.w - 1 - obj.ox), y = (obj.y + obj.h - 1)}

	local mid_left  = getMidpoint(top_left,  bot_left)
	local mid_right = getMidpoint(top_right, bot_right)
	local mid_top   = getMidpoint(top_left, top_right)
	local mid_bot   = getMidpoint(bot_left, bot_right)

	pix(top_left.x, top_left.y, 14)
	pix(bot_left.x, bot_left.y, 14)
	pix(top_right.x, top_right.y, 14)
	pix(bot_right.x, bot_right.y, 14)

	pix(mid_left.x, mid_left.y, 14)
	pix(mid_right.x, mid_right.y, 14)
	pix(mid_top.x, mid_top.y, 14)
	pix(mid_bot.x, mid_bot.y, 14)

	print("x = " .. obj.x, 0, 0)
	print("y = " .. obj.y, 0, 10)
end

function get_flag(obj, dir, flag)
	local top_left  = {x = (obj.x + obj.ox),             y = (obj.y)}
	local bot_left  = {x = (obj.x + obj.ox),             y = (obj.y + obj.h - 1)}
	local top_right = {x = (obj.x + obj.w - 1 - obj.ox), y = (obj.y)}
	local bot_right = {x = (obj.x + obj.w - 1 - obj.ox), y = (obj.y + obj.h - 1)}
	local mid_left  = getMidpoint(top_left,  bot_left)
	local mid_right = getMidpoint(top_right, bot_right)
	local top_mid   = getMidpoint(top_left, top_right)
	local bot_mid   = getMidpoint(bot_left, bot_right)

	if dir == "left" then
		if fget(mget((top_left.x -1)/8, top_left.y/8), flag) or
		   fget(mget((mid_left.x -1)/8, mid_left.y/8), flag) or
		   fget(mget((bot_left.x -1)/8, bot_left.y/8), flag) then
			return true
		end
	end

	if dir == "right" then
		if fget(mget((top_right.x +1)/8, top_left.y/8), flag) or
		   fget(mget((mid_right.x +1)/8, mid_left.y/8), flag) or
		   fget(mget((bot_right.x +1)/8, bot_left.y/8), flag) then
			return true
		end
	end

	if dir == "up" then
		if fget(mget(top_left.x/8,  (top_left.y - 1)/8) , flag) or
		   fget(mget(top_mid.x/8,   (top_mid.y - 1)/8)  , flag) or
		   fget(mget(top_right.x/8, (top_right.y - 1)/8), flag) then
			return true
		end
	end

	if dir == "down" then
		if fget(mget(bot_left.x/8,  (bot_left.y + 1)/8) , flag) or
		   fget(mget(bot_mid.x/8,   (bot_mid.y + 1)/8)  , flag) or
		   fget(mget(bot_right.x/8, (bot_right.y + 1)/8), flag) then
			return true
		end
	end

	return false
end

-- function check_env(obj)
-- 	local bot_left  = {x = (obj.x + obj.ox),             y = (obj.y + obj.h - 1)}
-- 	local bot_right = {x = (obj.x + obj.w - 1 - obj.ox), y = (obj.y + obj.h - 1)}
-- 	local mid_bot   = getMidpoint(bot_left, bot_right)

-- 	if fget(mget(mid_bot.x/8, mid_bot.y/8), 1) and obj.dmg_cd == 0 then
-- 		obj.dy = -4
-- 		obj.hp = obj.hp - 1
-- 		obj.dmg_cd = 60
-- 	else
-- 		if obj.dmg_cd > 0 then
-- 			obj.dmg_cd = obj.dmg_cd - 1
-- 		end
-- 	end
-- end

function check_env(obj)
	if get_flag(obj, "down", 1) and obj.dmg_cd == 0 then
		obj.dy = -4
		obj.hp = obj.hp - 1
		obj.dmg_cd = 60
	elseif get_flag(obj, "left", 1) and obj.dmg_cd == 0 then
		obj.dx = 4
		obj.hp = obj.hp - 1
		obj.dmg_cd = 60
	elseif get_flag(obj, "right", 1) and obj.dmg_cd == 0 then
		obj.dx = -4
		obj.hp = obj.hp - 1
		obj.dmg_cd = 60
	else
		if obj.dmg_cd > 0 then
			obj.dmg_cd = obj.dmg_cd - 1
		end
	end
end

function update_player()
    player_input()
	gravity(player)

	collision_x(player)
	player.x = player.x + player.dx
	collision_y(player)
	player.y = player.y + player.dy
	
	check_env(player)

	--print(get_flag(player, "down", 1), 10, 20)
	

    player_states()

end

function draw_object(obj)
	if t % obj.anim.speed == 0 then
		obj.counter = obj.counter + 1
		if obj.anim.loop == 1 then
			obj.counter = obj.counter % obj.anim.num
		elseif obj.counter > obj.anim.num -1 then
			obj.counter = obj.anim.num -1
		end
	end
	
	local offset_rows = math.floor(obj.anim.id/(16 * obj.anim.h))
	local offset_cols = (obj.anim.id - (offset_rows * 16 * obj.anim.h)) / obj.anim.w
	local offset = offset_rows * 8 + offset_cols
	local sprite_id = ((obj.counter + offset) * obj.anim.w) % 16 + math.floor((obj.counter +offset) * obj.anim.w / 16) * 16 * obj.anim.h
	
	if obj.dmg_cd > 0 and obj.dmg_cd % 4 == 0 then 
		spr(100, obj.x, obj.y, 0, 1, obj.flip, 0, obj.anim.w, obj.anim.h)
	else
		spr(sprite_id, obj.x - camera.x, obj.y, 5, 1, obj.flip, 0, obj.anim.w, obj.anim.h)
	end
	return obj.counter
end

-- gravity --
function gravity(obj)
    if obj.on_ground == false then
        obj.dy = obj.dy + GRAVITY
        if obj.dy > 7 then
            obj.dy = 7
        end
		if obj.dx > 0 then
			obj.dx = math.floor(10*obj.dx * AIR)/10
		elseif obj.dx < 0 then
			obj.dx = math.ceil(10*obj.dx * AIR)/10
		end
    else
		if obj.dx > 0 then
			obj.dx = math.floor(10*obj.dx * FRICTION)/10
		elseif obj.dx < 0 then
			obj.dx = math.ceil(10*obj.dx * FRICTION)/10
		end
	end

end

-- collisions --
function getMidpoint(p1, p2)
  local midX = math.floor((p1.x + p2.x) / 2)
  local midY = math.floor((p1.y + p2.y) / 2)
  return {x = midX, y = midY}
end

function collision_x(obj)
    -- x axis --
    local top_left  = {x = (obj.x - 1 + obj.ox + obj.dx),      y = (obj.y)}
    local top_right = {x = (obj.x + obj.w - obj.ox + obj.dx),  y = (obj.y)}
    local bot_left  = {x = (obj.x - 1 + obj.ox + obj.dx),      y = (obj.y + obj.h - 1)}
    local bot_right = {x = (obj.x + obj.w - obj.ox + obj.dx),  y = (obj.y + obj.h - 1)}
    local mid_left  = getMidpoint(top_left,  bot_left)
    local mid_right = getMidpoint(top_right, bot_right)

    if fget(mget(top_left.x/8, top_left.y/8),0) or
       fget(mget(mid_left.x/8, mid_left.y/8),0) or
       fget(mget(bot_left.x/8, bot_left.y/8),0) then
        if obj.dx < 0 then
		    obj.dx = math.ceil(top_left.x/8)*8 - (obj.x + obj.ox)
        end
    end

    if fget(mget(top_right.x/8, top_right.y/8),0) or
       fget(mget(mid_right.x/8, mid_right.y/8),0) or
       fget(mget(bot_right.x/8, bot_right.y/8),0) then
        if obj.dx > 0 then
            obj.dx = math.floor((top_right.x)/8)*8 - (obj.x + obj.w - obj.ox)
        end
    end
end

function collision_y(obj)
    -- y axis --
    local top_left  = {x = (obj.x + obj.ox),      		 y = (obj.y - 1 + obj.dy)}
    local top_right = {x = (obj.x + obj.w -1 - obj.ox),  y = (obj.y - 1 + obj.dy)}
    local bot_left  = {x = (obj.x + obj.ox),      	     y = (obj.y + obj.h + obj.dy)}
    local bot_right = {x = (obj.x + obj.w -1 - obj.ox),  y = (obj.y + obj.h + obj.dy)}
    local top_mid   = getMidpoint(top_left, top_right)
    local bot_mid   = getMidpoint(bot_left, bot_right)

    if fget(mget(top_left.x/8,  top_left.y/8),0) or
       fget(mget(top_mid.x/8,   top_mid.y/8),0) or
       fget(mget(top_right.x/8, top_right.y/8),0) then
        if obj.dy < 0 then
		    obj.dy = math.ceil(top_mid.y/8)*8 - (obj.y)
        end
    end

    if (fget(mget(bot_left.x/8,  bot_left.y/8),0) or
       fget(mget(bot_mid.x/8,   bot_mid.y/8),0) or
       fget(mget(bot_right.x/8, bot_right.y/8),0)) then
		player.on_ground = true
		if obj.dy > 0 then
            obj.dy = math.floor(bot_mid.y/8)*8 - (obj.y + obj.h)
        end
	else
		player.on_ground = false
	end
end

-- <TILES>
-- 000:5555555555555555555555555555555555555555555555555555555555555555
-- 001:4424443434243444442444442222222244444244434442434434424422222222
-- 002:7777777778787878888888887878787888888888888888888788878888888888
-- 003:cdfeeeffdfeeeefefeeeedffeeeecfffeeedffeefffffeeefeeeeeedfdeeeedf
-- 004:555555555555555555555555555555555555555555555555e55555f5def55fef
-- 005:7777777d7878787f888888887878787e8888888e888888888788878f88888888
-- 006:d7777777f787878788888888e7878787e888888888888888f878887888888888
-- 007:55555555552222225555333355555555555555335f2222225555333355555555
-- 008:5555555555f55555552555255525552553255325532553255323532553235325
-- 009:333333333a3a3a3aaaaaaaaa3a3a3a3aaaaaaaaaaaaaaaaaa3aaa3aaaaaaaaaa
-- 010:333777777a7a7878aaaaaa883a3a7a788aaaaa88aaa8aa88a7aaa788a8aaa888
-- 011:777773338787a7a788aaaaaa87a7a3a388aaaaa888aa8aaa887aaa7a888aaa8a
-- 012:6666666664646464444444445454545444444444444444444544544444444444
-- 018:8888888888878888888888888888888888888888888888788788888888888888
-- 021:8888888888878888888888888888888e8888888e888888ef8788888e8888888d
-- 022:888888888888788888888888e8888888e8888888fe888888e8888878d8888888
-- 025:aaaaaaaaaaa3aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa3aa3aaaaaaaaaaaaaa
-- 026:aaaaa888aaa3aa88a8aaaa88aaaaaaa8aaaa8aa8aaaaaa78a78aaa88a8aaaa88
-- 027:888aaaaa88aa3aaa88aaaa8a8aaaaaaa8aa8aaaa87aaaaaa88aaa87a88aaaa8a
-- 028:4444444444454444444444444444444444444444444444544544444444444444
-- 032:00cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede
-- 033:cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede00
-- 034:4343434332323232434343433232323243434343323232324343434332323232
-- 035:4343434332323232434343433232323243434343323232324343434332323232
-- 036:0202020220202020020202022020202002020202202020200202020220202020
-- 048:00cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede
-- 049:cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede00cdcdcd00dedede00
-- 050:4343434332323232434343433232323243434343323232324343434332323232
-- 051:4343434332323232434343433232323243434343323232324343434332323232
-- 080:5555555555555555555555555555555555555555555555555555555555575858
-- 081:5555555555555555555555555555555555555555555555557555555575857585
-- 082:5555555555555555555555555555555555555555555555557555555575857585
-- 083:5555555555555555555555555555555555555555555555557555555575857555
-- 084:5555555555555555555555885555557855555788555558895555788855578888
-- 085:5555555555555555955555558855555598555555877555559875555589855555
-- 088:5555555655555564555556445555564355566444556443345644444364444444
-- 089:6655555544665555444465554444366533433336433344444344443333443344
-- 090:5555555555555555555555555555555555665555664465554444366544444336
-- 096:55870887588888885888888857888888570788075fdddfdf5ffffddf5fdfffff
-- 097:7880788088888888888888888888888870887088dddfddddfdfdddddffffddff
-- 098:7880788088888888888888888888888870887088fdfddddffddffffdfffffddf
-- 099:7880785588888885888888858888887570887075fdfdddf5fddffff5fffffdf5
-- 100:5555788855557888555588875555888855577788555578785555898855558898
-- 101:8898555588855555889855557885555588855555888555558777555588755555
-- 104:6334444356633333555666665555555555555555555555555555555555555555
-- 105:3333333366666666555555555555555555555555555555555555555555555555
-- 106:3333666566665555555555555555555555555555555555555555555555555555
-- 112:5fff000f5f00ffff55fff0005f00000055f000005f0fdf005f0000005f000000
-- 113:000ffffffff000f0000fff00f00000000000000f000000000fdf0f0000000000
-- 114:f000ffffffff00f0000fff00000000f00000000000fdf00000000000000000f0
-- 115:f000fff5ffff00f5000fff55000000f500000f5500fdf0f5000000f5000000f5
-- 116:5555898955588898555578785555778855557788555777875555777855555770
-- 117:8885555588855555877555559877555588885555888755557775555507555555
-- 120:5555555555555555555566565556446455564444566444436444433363333333
-- 121:5666555564446556444446644444433444443344444443343444443333444433
-- 122:6655555544655555444655554446555544446655443344654344444633344436
-- 128:fff00000fd0000007000000070000000f0000000ff000000f0000000f0000000
-- 129:00000fff000000df00000007000000070000000f000000ff0000000f0000000f
-- 130:5ff000005f00000055f000005f00000055f000005f00f0005f0000005f000000
-- 131:00000ff5000000f500000f55000000f500000f55000f00f5000000f5000000f5
-- 132:55555500555555005555550f5555550f55555500555555005555550f55555500
-- 133:f5555555f5555555f5555555f5555555f5555555f5555555f5555555f5555555
-- 136:5666666355555556555555555555555555555555555555555555555555555555
-- 137:3333333663333665566665555555555555555555555555555555555555555555
-- 138:6633336555666655555555555555555555555555555555555555555555555555
-- 144:0f000000000000000000000000f0000000000000f0000000000000000f000000
-- 145:000000f0000000000000000000000f00000000000000000f00000000000000f0
-- 240:100110010fe00ee00feeeee00ffeeee010ffee01110ff0111110011111111111
-- 241:11100111100aa0010aaaaaa00aaaaaa010aaaa010aaaaaa00aa00aa010011001
-- 242:11111111111000011101101110110111100100110de0de010ef0ef0110010011
-- 243:1117111111797111179887117988887117888711117871111117111111111111
-- 244:1116111111646111164556116455556116555611116561111116111111111111
-- 245:1fffff11fdddddf1fdeeeef1fdeeeef1fdeeeef1feeeeef11fffff1111111111
-- 246:11ddd1111d444d11d4aaabd1d4aaabd1d4aaabd11dbbbd1111ddd11111111111
-- </TILES>

-- <SPRITES>
-- 000:555555ff555555ff555555f0555555fb5555555b5555523d5555223355552533
-- 001:ff555555bf555555b0555555bb555555b5555555d55555553255555532555555
-- 002:555555ff555555ff555555f0555555fb5555555b5555555d5555523355552233
-- 003:ff555555bf555555b0555555bb555555b5555555d55555553355555532555555
-- 004:55555555555555ff555555ff555555f0555555fb5555555b5555555d55555223
-- 005:55555555ff555555bf555555b0555555bb555555b5555555d555555533555555
-- 006:5555555555555555555555ff555555ff555555f0555555fb5555555b5555522d
-- 007:5555555555555555ff555555bf555555b0555555bb555555b5555555d3555555
-- 008:5555555555555555555555ff555555ff555555f0555555fb5555555b5555522d
-- 009:5555555555555555ff555555bf555555b0555555bb555555b5555555d3555555
-- 010:55555555555555ff555555ff555555f0555555fb5555555b5555555d55555223
-- 011:55555555ff555555bf555555b0555555bb555555b5555555d555555533555555
-- 012:555555ff555555ff555555f0555555fb5555555b5555555d5555523355552233
-- 013:ff555555bf555555b0555555bb555555b5555555d55555553355555532555555
-- 014:555555ff555555ff555555f0555555fb5555555b5555523d5555223355552533
-- 015:ff555555bf555555b0555555bb555555b5555555d55555553255555532555555
-- 016:555525dd555526665555b6665555566555556655555565555556655555525555
-- 017:d225555565255555662b55556665555556655555556555555565555555255555
-- 018:555525dd555526665555b6665555566555556655555565555556655555525555
-- 019:d255555565255555666b55556665555556655555556555555565555555255555
-- 020:55552233555525d35555b66d5555566655556665555566555556655555525555
-- 021:3255555535255555d55b55556655555556655555556555555565555555255555
-- 022:555522335555253355552ddd5555b66655556665555566555555655555522555
-- 023:3255555532255555d5225555665b555566655555556555555565555555255555
-- 024:555522335555253355552ddd5555b66655556665555566555555655555522555
-- 025:3255555532255555d5225555665b555566655555556555555565555555255555
-- 026:55552233555525d35555b66d5555566655556665555566555556655555525555
-- 027:3255555535255555d55b55556655555556655555556555555565555555255555
-- 028:555525dd555526665555b6665555566555556655555565555556655555525555
-- 029:d255555565255555666b55556665555556655555556555555565555555255555
-- 030:555525dd555526665555b6665555566555556655555565555556655555525555
-- 031:d225555565255555662b55556665555556655555556555555565555555255555
-- 032:5555555f5555555f5555555f5555555f55555555555552225555223255552533
-- 033:fff55555fbf555550b055555bbb55555bb5555553355555523555555255b5555
-- 034:5555555555555555555555555555555555555555555555535555552355555223
-- 035:55555555ffff5555ffbf5555f0b05555fbbb55553bb555553355555533555555
-- 036:5555555555555555555555555555555555555555555555335555223355522333
-- 037:ffff5555ffbf5555f0b05555fbbb55555bb55555355555553555555532255555
-- 038:55555555555555555555555555555555555222555522522355bb553355555533
-- 039:ffff5555ffbf5555f0b05555fbbb55555bb5555533555b553325225535522555
-- 040:5555555555555555555555555555555555555555555552235555223355525533
-- 041:ffff5555ffbf5555f0b05555fbbb55555bb5555533555555332555553522b555
-- 042:5555555555555555555555555555555555555555555555535555522255552233
-- 043:55555555ffff5555ffbf5555f0b05555fbbb55553bb555553355555533555555
-- 044:5555555555555555555555555555555555555555555555535555523255552232
-- 045:ffff5555ffbf5555f0b05555fbbb55555bb55555335555553355555533555555
-- 046:5555555f5555555f5555555f5555555f555525555552223255b2553255555533
-- 047:fff55555fbf555550b055555bbb55555bb5b5555235255552222555532255555
-- 048:555b253355555ddd555556665555666666666655255555555555555555555555
-- 049:22225555d5555555665555556665555555665555556655555556555555525555
-- 050:55555233555552225555566b5555556655555666555556665555556655555522
-- 051:35555555db555555555555556555555565555555555555555555555555555555
-- 052:552255dd55225666555556665555665555566555556655555665555552255555
-- 053:d522555566655555666655555566555555525555555555555555555555555555
-- 054:555555dd55555666555566665266666552555555555555555555555555555555
-- 055:d555555566655555666655555556655555556255555525555555555555555555
-- 056:55b255dd55555666555556665266666655566555555555555555555555555555
-- 057:d555555565555555665555556665555556655555556555555565555555225555
-- 058:55552533555522bd555552b65555566655555666555556555555565555552255
-- 059:35555555d5555555665555556665555566555555555555555555555555555555
-- 060:555225d2555bb566555556665555666555566655556655555265555555255555
-- 061:2555555522b65555666655555556555555522555555555555555555555555555
-- 062:555555dd55555666555566665556666526666555255555555555555555555555
-- 063:d555555566555555666555555666555555566555555522555555555555555555
-- 064:5555555f5555555f5555555f5555555f55555552555555225555522d55552255
-- 065:fff55555fb055555bbb55555bb555555333555553332555533325555ddd22555
-- 066:555555ff555555ff555555fb555555fb5555552355555223555522d35555255d
-- 067:ff555555b0555555bb555555b5555555325555553325555533225555dd522555
-- 068:555555ff555555ff555555fb555555fb5555522355552223555225d35552255d
-- 069:ff555555b0555555bb555555b5555555322555553322555533552555dd522555
-- 070:555555ff555555ff555555fb555225fb552222335225523355555dd35555556d
-- 071:ff555555b0555555bb555555b5255555322255553252255535555555d6655555
-- 072:555555ff555555ff555555fb552225fb522522335525523355555dd35555556d
-- 073:ff555555b0555555bb555555b5255555322225553255255535555555d6655555
-- 074:555555ff555555ff555555fb552225fb522522335555523355555dd35555556d
-- 075:ff555555b0555555bb555555b5225555325555553255555535555555d6655555
-- 076:5555555555555555555555555555555555555555555555555555555555555555
-- 077:5555555555555555555555555555555555555555555555555555555555555555
-- 078:5555555555555555555555555555555555555555555555555555555555555555
-- 079:5555555555555555555555555555555555555555555555555555555555555555
-- 080:5555225555552256555552565555555655555566555555665555566555555665
-- 081:6665225566665255666665556556655555665555566555555655555555555555
-- 082:5555255655552566555555665555556655555566555555655555566555555655
-- 083:6652255566655555666665555566555556655555665555556555555555555555
-- 084:5555255655555566555555565555555655555556555555665555555555555555
-- 085:6655555566665555666655556666555566555555655555555555555555555555
-- 086:5555556655555566555555665555555655555556555555565555555555555555
-- 087:6665555566655555666555556655555556555555555555555555555555555555
-- 088:5555556655555566555555565555555655555556555555565555555555555555
-- 089:6665555566655555665555556655555565555555555555555555555555555555
-- 090:5555556655555566555555665555556655555565555555655555556555555565
-- 091:6665555566555555665555556555555555555555555555555555555555555555
-- 092:5555555555555555555555555555555555555555555555555555555555555555
-- 093:5555555555555555555555555555555555555555555555555555555555555555
-- 094:5555555555555555555555555555555555555555555555555555555555555555
-- 095:5555555555555555555555555555555555555555555555555555555555555555
-- 096:55555555555555555555559555555592555552225555e2225555eeec5555eeec
-- 097:5555555555555555bb555555bbb55555bbb55555bb155555c5555555c5555555
-- 098:5555555555555555555555555555555555555ccc555eaecc5555aaec5555aaae
-- 099:55555555555555555555555555555555cc555555cccbb555cebbbb55229bbb55
-- 100:5555555555555555555e555555eee55a55e5ccca55555cca555555cc55555555
-- 101:5aa5555555a55555aa555555a5555555aa555555aaa55555aeec5555eeee5555
-- 102:55555555555555555555aaa555555aa5555555aa555555aa5551155a52bb115a
-- 103:555555555555555555e5555555ee55555ce55555acc55555aac55555aac55555
-- 104:555555555555555555555555555bb55555bbbb5555bbbbcc55522ccc52222ecc
-- 105:5555555555555555555555555555555555555555555aaaa5c5aa5555ccaacc55
-- 106:5555555555555555555555bb55555bbb55555bbb55522ebb52222ecc92555ecc
-- 107:555555555555555555555555b5555555b155555515115555c55ee555c5555555
-- 108:5555555555555555555555555555555555555555555555555555555555555555
-- 109:5555555555555555555555555555555555555555555555555555555555555555
-- 110:5555555555555555555555555555555555555555555555555555555555555555
-- 111:5555555555555555555555555555555555555555555555555555555555555555
-- 112:5555eecc5555aaac55555aaa5555555a5555555a5555555a5555555555555555
-- 113:cc555555cccc5555aee5555555e5555555555555555555555555555555555555
-- 114:55aaaa555555aa55555555555555555555555555555555555555555555555555
-- 115:299bb15522211555255155555555555555555555555555555555555555555555
-- 116:5555522255551222555512925555599b55555bbb555555bb5555555555555555
-- 117:ceee55552eee55552ee55555b5555555b5555555555555555555555555555555
-- 118:522bb1ce9222bcce59522eee5555eeee55555555555555555555555555555555
-- 119:aaa55555eac55555ee555555e555555555555555555555555555555555555555
-- 120:925551ec9555551e55555ee55555555555555555555555555555555555555555
-- 121:caaacceeeaaa555e555555555555555555555555555555555555555555555555
-- 122:595555ec555555ee5555555a5555555a555555ee555555e55555555555555555
-- 123:e5555555ac555555acc55555acc55555aa5555555aa555555aa555555a555555
-- 124:5555555555555555555555555555555555555555555555555555555555555555
-- 125:5555555555555555555555555555555555555555555555555555555555555555
-- 126:5555555555555555555555555555555555555555555555555555555555555555
-- 127:5555555555555555555555555555555555555555555555555555555555555555
-- 128:5555555555555555555555555555555555555555555555555555555555555555
-- 129:5555555555555555555555555555555555555555555555555555555555555555
-- 130:5555555555555555555555555555555555555555555555555555555555555555
-- 131:5555555555555555555555555555555555555555555555555555555555555555
-- 132:5555555555555555555555555555555555555555555555555555555555555555
-- 133:5555555555555555555555555555555555555555555555555555555555555555
-- 134:5555555555555555555555555555555555555555555555555555555555555555
-- 135:5555555555555555555555555555555555555555555555555555555555555555
-- 136:5555555555555555555555555555555555555555555555555555555555555555
-- 137:5555555555555555555555555555555555555555555555555555555555555555
-- 138:5555555555555555555555555555555555555555555555555555555555555555
-- 139:5555555555555555555555555555555555555555555555555555555555555555
-- 140:5555555555555555555555555555555555555555555555555555555555555555
-- 141:5555555555555555555555555555555555555555555555555555555555555555
-- 142:5555555555555555555555555555555555555555555555555555555555555555
-- 143:5555555555555555555555555555555555555555555555555555555555555555
-- 144:5555555555555555555555555555555555555555555555555555555555555555
-- 145:5555555555555555555555555555555555555555555555555555555555555555
-- 146:5555555555555555555555555555555555555555555555555555555555555555
-- 147:5555555555555555555555555555555555555555555555555555555555555555
-- 148:5555555555555555555555555555555555555555555555555555555555555555
-- 149:5555555555555555555555555555555555555555555555555555555555555555
-- 150:5555555555555555555555555555555555555555555555555555555555555555
-- 151:5555555555555555555555555555555555555555555555555555555555555555
-- 152:5555555555555555555555555555555555555555555555555555555555555555
-- 153:5555555555555555555555555555555555555555555555555555555555555555
-- 154:5555555555555555555555555555555555555555555555555555555555555555
-- 155:5555555555555555555555555555555555555555555555555555555555555555
-- 156:5555555555555555555555555555555555555555555555555555555555555555
-- 157:5555555555555555555555555555555555555555555555555555555555555555
-- 158:5555555555555555555555555555555555555555555555555555555555555555
-- 159:5555555555555555555555555555555555555555555555555555555555555555
-- 160:5555555555555555555555555555555555555555555555555555555555555555
-- 161:5555555555555555555555555555555555555555555555555555555555555555
-- 162:5555555555555555555555555555555555555555555555555555555555555555
-- 163:5555555555555555555555555555555555555555555555555555555555555555
-- 164:5555555555555555555555555555555555555555555555555555555555555555
-- 165:5555555555555555555555555555555555555555555555555555555555555555
-- 166:5555555555555555555555555555555555555555555555555555555555555555
-- 167:5555555555555555555555555555555555555555555555555555555555555555
-- 168:5555555555555555555555555555555555555555555555555555555555555555
-- 169:5555555555555555555555555555555555555555555555555555555555555555
-- 170:5555555555555555555555555555555555555555555555555555555555555555
-- 171:5555555555555555555555555555555555555555555555555555555555555555
-- 172:5555555555555555555555555555555555555555555555555555555555555555
-- 173:5555555555555555555555555555555555555555555555555555555555555555
-- 174:5555555555555555555555555555555555555555555555555555555555555555
-- 175:5555555555555555555555555555555555555555555555555555555555555555
-- 176:5555555555555555555555555555555555555555555555555555555555555555
-- 177:5555555555555555555555555555555555555555555555555555555555555555
-- 178:5555555555555555555555555555555555555555555555555555555555555555
-- 179:5555555555555555555555555555555555555555555555555555555555555555
-- 180:5555555555555555555555555555555555555555555555555555555555555555
-- 181:5555555555555555555555555555555555555555555555555555555555555555
-- 182:5555555555555555555555555555555555555555555555555555555555555555
-- 183:5555555555555555555555555555555555555555555555555555555555555555
-- 184:5555555555555555555555555555555555555555555555555555555555555555
-- 185:5555555555555555555555555555555555555555555555555555555555555555
-- 186:5555555555555555555555555555555555555555555555555555555555555555
-- 187:5555555555555555555555555555555555555555555555555555555555555555
-- 188:5555555555555555555555555555555555555555555555555555555555555555
-- 189:5555555555555555555555555555555555555555555555555555555555555555
-- 190:5555555555555555555555555555555555555555555555555555555555555555
-- 191:5555555555555555555555555555555555555555555555555555555555555555
-- 192:5555555555555555555555555555555555555555555555555555555555555555
-- 193:5555555555555555555555555555555555555555555555555555555555555555
-- 194:5555555555555555555555555555555555555555555555555555555555555555
-- 195:5555555555555555555555555555555555555555555555555555555555555555
-- 196:5555555555555555555555555555555555555555555555555555555555555555
-- 197:5555555555555555555555555555555555555555555555555555555555555555
-- 198:5555555555555555555555555555555555555555555555555555555555555555
-- 199:5555555555555555555555555555555555555555555555555555555555555555
-- 200:5555555555555555555555555555555555555555555555555555555555555555
-- 201:5555555555555555555555555555555555555555555555555555555555555555
-- 202:5555555555555555555555555555555555555555555555555555555555555555
-- 203:5555555555555555555555555555555555555555555555555555555555555555
-- 204:5555555555555555555555555555555555555555555555555555555555555555
-- 205:5555555555555555555555555555555555555555555555555555555555555555
-- 206:5555555555555555555555555555555555555555555555555555555555555555
-- 207:5555555555555555555555555555555555555555555555555555555555555555
-- 208:5555555555555555555555555555555555555555555555555555555555555555
-- 209:5555555555555555555555555555555555555555555555555555555555555555
-- 210:5555555555555555555555555555555555555555555555555555555555555555
-- 211:5555555555555555555555555555555555555555555555555555555555555555
-- 212:5555555555555555555555555555555555555555555555555555555555555555
-- 213:5555555555555555555555555555555555555555555555555555555555555555
-- 214:5555555555555555555555555555555555555555555555555555555555555555
-- 215:5555555555555555555555555555555555555555555555555555555555555555
-- 216:5555555555555555555555555555555555555555555555555555555555555555
-- 217:5555555555555555555555555555555555555555555555555555555555555555
-- 218:5555555555555555555555555555555555555555555555555555555555555555
-- 219:5555555555555555555555555555555555555555555555555555555555555555
-- 220:5555555555555555555555555555555555555555555555555555555555555555
-- 221:5555555555555555555555555555555555555555555555555555555555555555
-- 222:5555555555555555555555555555555555555555555555555555555555555555
-- 223:5555555555555555555555555555555555555555555555555555555555555555
-- 224:5555555555555555555555555555555555555555555555555555555555555555
-- 225:5555555555555555555555555555555555555555555555555555555555555555
-- 226:5555555555555555555555555555555555555555555555555555555555555555
-- 227:5555555555555555555555555555555555555555555555555555555555555555
-- 228:5555555555555555555555555555555555555555555555555555555555555555
-- 229:5555555555555555555555555555555555555555555555555555555555555555
-- 230:5555555555555555555555555555555555555555555555555555555555555555
-- 231:5555555555555555555555555555555555555555555555555555555555555555
-- 232:5555555555555555555555555555555555555555555555555555555555555555
-- 233:5555555555555555555555555555555555555555555555555555555555555555
-- 234:5555555555555555555555555555555555555555555555555555555555555555
-- 235:5555555555555555555555555555555555555555555555555555555555555555
-- 236:5555555555555555555555555555555555555555555555555555555555555555
-- 237:5555555555555555555555555555555555555555555555555555555555555555
-- 238:5555555555555555555555555555555555555555555555555555555555555555
-- 239:5555555555555555555555555555555555555555555555555555555555555555
-- 240:5555555555555555555555555555555555555555555555555555555555555555
-- 241:5555555555555555555555555555555555555555555555555555555555555555
-- 242:5555555555555555555555555555555555555555555555555555555555555555
-- 243:5555555555555555555555555555555555555555555555555555555555555555
-- 244:5555555555555555555555555555555555555555555555555555555555555555
-- 245:5555555555555555555555555555555555555555555555555555555555555555
-- 246:5555555555555555555555555555555555555555555555555555555555555555
-- 247:5555555555555555555555555555555555555555555555555555555555555555
-- 248:5555555555555555555555555555555555555555555555555555555555555555
-- 249:5555555555555555555555555555555555555555555555555555555555555555
-- 250:5555555555555555555555555555555555555555555555555555555555555555
-- 251:5555555555555555555555555555555555555555555555555555555555555555
-- 252:5555555555555555555555555555555555555555555555555555555555555555
-- 253:5555555555555555555555555555555555555555555555555555555555555555
-- 254:5555555555555555555555555555555555555555555555555555555555555555
-- 255:5555555555555555555555555555555555555555555555555555555555555555
-- </SPRITES>

-- <MAP>
-- 000:00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008797a7000000000000000000000000008797a7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 001:00000000000000000000101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008898a8000000000000000000000000008898a80000008797a7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 002:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008595a5000000000000008797a7000000000000000000000000008898a8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 003:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008696a6000000000000008898a800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 004:00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008797a70000000000000000000000008595a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 005:00000000101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008898a80000000000000000000000008696a600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 006:000000001010101000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 007:000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 008:000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 009:000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000004555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 010:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004656000005251525350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 011:000000000000000000000000000000000000007010101010000000000000000000000000001010000000000000000000000010101010000000000000000045554555455500000000000000000000004757000006261626360045550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 012:000000000000000000000000000000000000007010101010000000000000000010100000000000000000000000000000000010101010000000000000000046564656465600000000000000000000054858152507271727370046560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 013:000000000000000010000000000000001010101010101010101000000000000000000000000000000000000000001010101010101010101000000000000047574757475700000000000000000000061626162608141414380047570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 014:051505150515051510404040404040401010101010101010101000000000000080808080808080808080808080001010101010101010101000000000152548584858485815251500152515001525071727172709293914381548582500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 015:202020202020202050303030303030306020202020202020202020202020b09090909090909090909090909090909090909090909090909090909090162616261626162616261626162616261626082929292929292929181626162600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 016:212121212121212151303030303030306121212121212121212121212121b19191919191919191919191919191919191919191919191919191919191172717271727172717271727172717271727092929292929292929191727172700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:00000000ffffffff00000000ffffffff
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000304000000000
-- </SFX>

-- <TRACKS>
-- 000:100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </TRACKS>

-- <FLAGS>
-- 000:00101030001010303010101010000000000010000010100000101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000000000000000000001010100000000000000000000000000000101000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </FLAGS>

-- <PALETTE>
-- 000:3200115f3a60876672b7a39dece8c26db7c35e80b26270578da24ed2cb3ef7d554e8bf92e78c5bc66f5ec33846933942
-- </PALETTE>
